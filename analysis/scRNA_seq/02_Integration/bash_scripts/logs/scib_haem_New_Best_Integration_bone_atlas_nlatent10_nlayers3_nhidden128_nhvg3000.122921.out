Reading unintegrated AnnData...
Unintegrated data loaded.
Reading integrated AnnData...
Integrated data loaded.
Starting evaluation...
Transferred Method and Haem_Category to integrated AnnData.
Aliased SCVI graph to neighbors/distances/connectivities.
/env/lib/python3.10/site-packages/scib/metrics/metrics.py:293: DeprecationWarning: Call to deprecated function (or staticmethod) opt_louvain.
  res_max, nmi_max, nmi_all = opt_louvain(
Clustering...
resolution: 0.1, nmi: 0.6799994729583597
resolution: 0.2, nmi: 0.6278724613539852
resolution: 0.3, nmi: 0.6366719765102941
resolution: 0.4, nmi: 0.6405515911965748
resolution: 0.5, nmi: 0.6421415942256115
resolution: 0.6, nmi: 0.6369825314602856
resolution: 0.7, nmi: 0.6096446646987388
resolution: 0.8, nmi: 0.6036823177720902
resolution: 0.9, nmi: 0.608301722331132
resolution: 1.0, nmi: 0.60349355201295
resolution: 1.1, nmi: 0.603833123259861
resolution: 1.2, nmi: 0.5999573205190821
resolution: 1.3, nmi: 0.6033595880897512
resolution: 1.4, nmi: 0.5871017853444754
resolution: 1.5, nmi: 0.5859566459616432
resolution: 1.6, nmi: 0.5799869203848476
resolution: 1.7, nmi: 0.5787131276584597
resolution: 1.8, nmi: 0.5728773026893536
resolution: 1.9, nmi: 0.5736973813561591
resolution: 2.0, nmi: 0.5729970442619848
optimised clustering against Haem_Category
optimal cluster resolution: 0.1
optimal score: 0.6799994729583597
NMI...
ARI...
Silhouette score...
Graph connectivity...
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
kBET...
batch: Method
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 4515.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 2557.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 734.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 182.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 1086.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 3984.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 98.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
Adding diffusion to step 5
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 2380.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 6196.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 280.
Use 70 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Adding diffusion to step 4
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 478.
Use 22 nearest neighbors.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
importing expression matrix
kBET estimation
Number of kBET tests is set to 25.
/env/lib/python3.10/site-packages/scib/metrics/highly_variable_genes.py:35: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  hvg_dir[i.obs[batch][0]] = i.var.index[hvg["highly_variable"]]
/env/lib/python3.10/site-packages/scib/metrics/highly_variable_genes.py:35: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  hvg_dir[i.obs[batch][0]] = i.var.index[hvg["highly_variable"]]
/env/lib/python3.10/site-packages/scib/metrics/highly_variable_genes.py:35: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  hvg_dir[i.obs[batch][0]] = i.var.index[hvg["highly_variable"]]
/env/lib/python3.10/site-packages/scib/metrics/highly_variable_genes.py:76: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  batch_var = ad_post.obs[batch_key][0]
/env/lib/python3.10/site-packages/scib/metrics/highly_variable_genes.py:76: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  batch_var = ad_post.obs[batch_key][0]
/env/lib/python3.10/site-packages/scib/metrics/highly_variable_genes.py:76: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  batch_var = ad_post.obs[batch_key][0]
Metrics saved to: /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/scib_output/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000_haem_evaluation_metrics_no_clisi.csv

------------------------------------------------------------
Sender: LSF System <lsfadmin@node-13-24>
Subject: Job 122921: <module load cellgen/singularity;      singularity exec --cleanenv --home /tmp/sm54 --bind /lustre,/nfs /nfs/cellgeni/singularity/images/scib-1.1.5.sif           python -u /nfs/team298/sm54/BoneAtlasProject/src/integration/09_evaluate_batch_correction_scvi_haem.py --adata_uninteg /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/bone_haem_atlas_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL_UNINTEGRADTED.h5ad                          --adata_int /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/umap_plots/processed_adata/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000.h5ad                          --output_csv /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/scib_output/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000_haem_evaluation_metrics_no_clisi.csv                          --batch_key Method                          --label_key Haem_Category> in cluster <farm22> Done

Job <module load cellgen/singularity;      singularity exec --cleanenv --home /tmp/sm54 --bind /lustre,/nfs /nfs/cellgeni/singularity/images/scib-1.1.5.sif           python -u /nfs/team298/sm54/BoneAtlasProject/src/integration/09_evaluate_batch_correction_scvi_haem.py --adata_uninteg /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/bone_haem_atlas_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL_UNINTEGRADTED.h5ad                          --adata_int /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/umap_plots/processed_adata/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000.h5ad                          --output_csv /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/scib_output/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000_haem_evaluation_metrics_no_clisi.csv                          --batch_key Method                          --label_key Haem_Category> was submitted from host <farm22-head1> by user <sm54> in cluster <farm22> at Sun Sep 21 19:38:39 2025
Job was executed on host(s) <8*node-13-24>, in queue <long>, as user <sm54> in cluster <farm22> at Mon Sep 22 10:18:30 2025
</nfs/users/nfs_s/sm54> was used as the home directory.
</nfs/team298/sm54/BoneAtlasProject/src/integration/bash_scripts> was used as the working directory.
Started at Mon Sep 22 10:18:30 2025
Terminated at Mon Sep 22 12:06:42 2025
Results reported at Mon Sep 22 12:06:42 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
module load cellgen/singularity;      singularity exec --cleanenv --home /tmp/sm54 --bind /lustre,/nfs /nfs/cellgeni/singularity/images/scib-1.1.5.sif           python -u /nfs/team298/sm54/BoneAtlasProject/src/integration/09_evaluate_batch_correction_scvi_haem.py --adata_uninteg /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/bone_haem_atlas_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL_UNINTEGRADTED.h5ad                          --adata_int /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/umap_plots/processed_adata/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000.h5ad                          --output_csv /nfs/team298/sm54/BoneAtlasProject/data/bone_haem_compartment/best_integration_with_filtered_stroma_PERMISSIVE_DOUBLET_REMOVAL/scib_output/New_Best_Integration_bone_atlas_nlatent10_nlayers3_nhidden128_nhvg3000_haem_evaluation_metrics_no_clisi.csv                          --batch_key Method                          --label_key Haem_Category
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   8700.18 sec.
    Max Memory :                                 78680 MB
    Average Memory :                             20648.62 MB
    Total Requested Memory :                     300000.00 MB
    Delta Memory :                               221320.00 MB
    Max Swap :                                   2 MB
    Max Processes :                              5
    Max Threads :                                35
    Run time :                                   6497 sec.
    Turnaround time :                            59283 sec.

The output (if any) is above this job summary.

