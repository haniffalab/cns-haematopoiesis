Reading unintegrated AnnData...
Unintegrated data loaded.
Reading integrated AnnData...
Integrated data loaded.
Starting evaluation...
Transferred Technology and majority_voting_Level2 to integrated AnnData.
Aliased SCVI graph to neighbors/distances/connectivities.
/env/lib/python3.10/site-packages/scib/metrics/metrics.py:293: DeprecationWarning: Call to deprecated function (or staticmethod) opt_louvain.
  res_max, nmi_max, nmi_all = opt_louvain(
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/graph_connectivity.py:56: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  tab = pd.value_counts(labels)
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:229: DeprecationWarning: The global conversion available with activate() is deprecated and will be removed in the next major release. Use a local converter.
  anndata2ri.activate()
Clustering...
resolution: 0.1, nmi: 0.4637625245064976
resolution: 0.2, nmi: 0.4533280003886006
resolution: 0.3, nmi: 0.4613145365080811
resolution: 0.4, nmi: 0.4650622403860169
resolution: 0.5, nmi: 0.4636536934638681
resolution: 0.6, nmi: 0.46428514741489446
resolution: 0.7, nmi: 0.459903697657746
resolution: 0.8, nmi: 0.4595928470450839
resolution: 0.9, nmi: 0.4588181082675368
resolution: 1.0, nmi: 0.4570414340502887
resolution: 1.1, nmi: 0.4508942680698846
resolution: 1.2, nmi: 0.4504746609660275
resolution: 1.3, nmi: 0.44715695951766554
resolution: 1.4, nmi: 0.44650530481818873
resolution: 1.5, nmi: 0.44417877831633434
resolution: 1.6, nmi: 0.44492449727934397
resolution: 1.7, nmi: 0.44191735247184755
resolution: 1.8, nmi: 0.442056278954827
resolution: 1.9, nmi: 0.4435068468075837
resolution: 2.0, nmi: 0.44195815537242034
optimised clustering against majority_voting_Level2
optimal cluster resolution: 0.4
optimal score: 0.4650622403860169
NMI...
ARI...
Silhouette score...
Graph connectivity...
kBET...
batch: Technology
Use 70 nearest neighbors.
Adding diffusion to step 4
Adding diffusion to step 5
Adding diffusion to step 6
Adding diffusion to step 7
Adding diffusion to step 8
Adding diffusion to step 9
importing expression matrix
kBET estimation
Number of kBET tests is set to 8020.
/env/lib/python3.10/site-packages/scib/metrics/kbet.py:158: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  comp_size = pd.value_counts(labs)
Terminated

------------------------------------------------------------
Sender: LSF System <lsfadmin@node-10-3-3>
Subject: Job 225454: <module load cellgen/singularity;           singularity exec --cleanenv --home /tmp/sm54 --bind /lustre,/nfs               /nfs/cellgeni/singularity/images/scib-1.1.5.sif               python 06_evaluate_batch_correction.py --adata_uninteg /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_filtered_with_metadata_scvi.h5ad                              --adata_int /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_scvi_runs/processed_adata/adata_nlatent15_nlayers2_nhidden128_nhvg10000.h5ad                              --output_csv /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_scvi_runs/scib_output/adata_nlatent15_nlayers2_nhidden128_nhvg10000_evaluation_metrics.csv                              --batch_key Technology                              --label_key majority_voting_Level2> in cluster <farm22> Exited

Job <module load cellgen/singularity;           singularity exec --cleanenv --home /tmp/sm54 --bind /lustre,/nfs               /nfs/cellgeni/singularity/images/scib-1.1.5.sif               python 06_evaluate_batch_correction.py --adata_uninteg /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_filtered_with_metadata_scvi.h5ad                              --adata_int /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_scvi_runs/processed_adata/adata_nlatent15_nlayers2_nhidden128_nhvg10000.h5ad                              --output_csv /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_scvi_runs/scib_output/adata_nlatent15_nlayers2_nhidden128_nhvg10000_evaluation_metrics.csv                              --batch_key Technology                              --label_key majority_voting_Level2> was submitted from host <farm22-head1> by user <sm54> in cluster <farm22> at Mon Jul 14 16:44:43 2025
Job was executed on host(s) <8*node-10-3-3>, in queue <long>, as user <sm54> in cluster <farm22> at Mon Jul 14 16:44:44 2025
</nfs/users/nfs_s/sm54> was used as the home directory.
</nfs/team298/sm54/BoneAtlasProject/src/integration> was used as the working directory.
Started at Mon Jul 14 16:44:44 2025
Terminated at Tue Jul 15 11:53:57 2025
Results reported at Tue Jul 15 11:53:57 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
module load cellgen/singularity;           singularity exec --cleanenv --home /tmp/sm54 --bind /lustre,/nfs               /nfs/cellgeni/singularity/images/scib-1.1.5.sif               python 06_evaluate_batch_correction.py --adata_uninteg /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_filtered_with_metadata_scvi.h5ad                              --adata_int /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_scvi_runs/processed_adata/adata_nlatent15_nlayers2_nhidden128_nhvg10000.h5ad                              --output_csv /lustre/scratch126/cellgen/haniffa/sm54/BoneAtlasProject/data/bone_atlas_scvi_runs/scib_output/adata_nlatent15_nlayers2_nhidden128_nhvg10000_evaluation_metrics.csv                              --batch_key Technology                              --label_key majority_voting_Level2
------------------------------------------------------------

TERM_MEMLIMIT: job killed after reaching LSF memory usage limit.
Exited with exit code 143.

Resource usage summary:

    CPU time :                                   194127.22 sec.
    Max Memory :                                 650699 MB
    Average Memory :                             101226.16 MB
    Total Requested Memory :                     650000.00 MB
    Delta Memory :                               -699.00 MB
    Max Swap :                                   2 MB
    Max Processes :                              4
    Max Threads :                                34
    Run time :                                   68950 sec.
    Turnaround time :                            68954 sec.

The output (if any) is above this job summary.

